---
title: "Patient visualisations"
author: "Edward Barker"
date: "March 28, 2022"
output: html_document
editor_options:
  markdown:
    wrap: 150
---

\

```{r setup, include=FALSE, echo=FALSE}
require("knitr")
opts_knit$set(root.dir = "")

library(ggplot2)
library(hrbrthemes)
library(tidyverse)
library(plotly)
library(BBmisc)
library(scales)
library(dplyr)
library(naniar)
library(gridExtra)
library(knitr)
library(moments)
library(formattable)
library(IRdisplay)
library(repr)
```

## Load in data files

### Outcome data

#### NBT Outcomes

```{r}
NBT_outcomes <- read.csv(file("NBT_outcomes.csv"))
NBT_outcomes = NBT_outcomes %>% 
  rename(
    admissionDate = admission_date,
  )
NBT_outcomes$admissionDate = as.Date(NBT_outcomes$admissionDate, format="%d/%m/%Y")
NBT_outcomes = NBT_outcomes %>% 
  rename(
    dischargeDate = discharge_date,
  )
NBT_outcomes$dischargeDate = as.Date(NBT_outcomes$dischargeDate, format="%d/%m/%Y")
NBT_outcomes_deaths = NBT_outcomes %>%
  filter(DischargeOutcomeDesc == "Patient Died")
NBT_outcomes_deaths$deathDate = NBT_outcomes_deaths$dischargeDate
NBT_outcomes <- merge(NBT_outcomes,NBT_outcomes_deaths,all=TRUE)
NBT_outcomes$ITU_Start = as.Date(NBT_outcomes$ITU_Start, format="%d/%m/%Y")
NBT_outcomes$ITU_End = as.Date(NBT_outcomes$ITU_End, format="%d/%m/%Y")
NBT_outcomes2 = NBT_outcomes %>% select(uob_ID,admissionDate,dischargeDate,ITU_Start,ITU_End,deathDate)
```

#### UHB Outcomes

```{r}
UHB_outcomes1 <- read.csv(file("UHB_outcomes1.ICU_Update.csv"))
UHB_outcomes1 = UHB_outcomes1 %>% 
  rename(
    admissionDate = attend_date,
  )
UHB_outcomes1$admissionDate = as.Date(UHB_outcomes1$admissionDate, format="%d/%m/%Y")
UHB_outcomes1$dischargeDate = as.Date(UHB_outcomes1$admissionDate + as.integer(UHB_outcomes1$hospital_length_of_stay))
UHB_outcomes1 = UHB_outcomes1 %>% 
  rename(
    deathDate = fu_death_date,
  )
UHB_outcomes1$deathDate = as.Date(UHB_outcomes1$deathDate, format="%d/%m/%Y")
UHB_outcomes1$ITU_Start <- as.Date(NA)
UHB_outcomes1$ITU_End <- as.Date(NA)
UHB_outcomes12 = UHB_outcomes1 %>% select(uob_ID,admissionDate,dischargeDate,ITU_Start,ITU_End,deathDate)

UHB_outcomes2 <- read.csv(file("UHB_outcomes2.ICU_Update.csv"))
UHB_outcomes2 = UHB_outcomes2 %>% 
  rename(
    admissionDate = attend_dte,
  )
UHB_outcomes2$admissionDate = as.Date(UHB_outcomes2$admissionDate, format="%d/%m/%Y")
UHB_outcomes2 = UHB_outcomes2 %>% 
  rename(
    dischargeDate = outcome_dte,
  )
UHB_outcomes2$dischargeDate = as.Date(UHB_outcomes2$dischargeDate, format="%d/%m/%Y")
UHB_outcomes2_deaths = UHB_outcomes2 %>%
  filter(outcome == 3)
UHB_outcomes2_deaths$deathDate = UHB_outcomes2_deaths$dischargeDate
UHB_outcomes2 <- merge(UHB_outcomes2,UHB_outcomes2_deaths,all=TRUE)
UHB_outcomes2$ITU_Start <- as.Date(NA)
UHB_outcomes2$ITU_End <- as.Date(NA)
UHB_outcomes22 = UHB_outcomes2 %>% select(uob_ID,admissionDate,dischargeDate,ITU_Start,ITU_End,deathDate)
```

#### Weston Outcomes

```{r}
WestonOutcomes <- read.csv(file("Weston.Outcomes.csv"))
WestonOutcomes = WestonOutcomes %>% 
  rename(
    admissionDate = Admission.date,
  )
WestonOutcomes$admissionDate = as.Date(WestonOutcomes$admissionDate, format="%d/%m/%Y")
WestonOutcomes = WestonOutcomes %>% 
  rename(
    dischargeDate = Discharge.date,
  )
WestonOutcomes$dischargeDate = as.Date(WestonOutcomes$dischargeDate, format="%d/%m/%Y")
WestonOutcomes = WestonOutcomes %>% 
  rename(
    ITU_Start = ICU.Admission.Date
  )
WestonOutcomes$ITU_Start = as.Date(WestonOutcomes$ITU_Start, format="%d/%m/%Y")
WestonOutcomes = WestonOutcomes %>% 
  rename(
    ITU_End = ICU.Discharge.Date
  )
WestonOutcomes$ITU_End = as.Date(WestonOutcomes$ITU_End, format="%d/%m/%Y")
WestonOutcomes = WestonOutcomes %>% 
  rename(
    deathDate = Date.of.Death
  )
WestonOutcomes$deathDate = as.Date(WestonOutcomes$deathDate, format="%d/%m/%Y")
WestonOutcomes2 = WestonOutcomes %>% select(uob_ID,admissionDate,dischargeDate,ITU_Start,ITU_End,deathDate)
```

### Merge Outcome data

```{r}
## Demographics Table
dem <- read.csv(file("masterlist.update.csv"))
dem <- dem %>%
  rename(Age = agecat) %>%
  distinct(uob_ID, .keep_all = TRUE) %>%
  dplyr::select(uob_ID,Gender,Age)

# Merge outcomes data
totalOutcomes <- rbind(UHB_outcomes12,UHB_outcomes22,NBT_outcomes2,WestonOutcomes2) # NBT Outcomes must be excluded as inconsistent
totalOutcomes$deathDate = as.Date(totalOutcomes$deathDate, format="%d/%m/%Y")
totalOutcomes$ITU_Start = as.Date(totalOutcomes$ITU_Start, format="%d/%m/%Y")
totalOutcomes$ITU_End = as.Date(totalOutcomes$ITU_End, format="%d/%m/%Y")
totalOutcomes$dischargeDate = as.Date(totalOutcomes$dischargeDate, format="%d/%m/%Y")
```

### Load variable data

#### BE - Bicarbonate Excess

```{r}
BE <- read.csv(file("BE.csv"))
BE$Date.Booked.In = as.Date(BE$Date.Booked.In, format="%d/%m/%Y")
BE = BE %>% 
  rename(
    date = Date.Booked.In,
  )
BE = BE %>%
  rename(
    BE_val = Numeric.Result
  )
```

#### BNP - B-type natriuretic peptide

```{r}
BNP <- read.csv(file("BNP.csv"))
BNP$Date.Booked.In = as.Date(BNP$Date.Booked.In, format="%d/%m/%Y")
BNP = BNP %>% 
  rename(
    date = Date.Booked.In,
  )
BNP = BNP %>%
  rename(
    BNP_val = Numeric.Result
  )
```

#### CRP - C-Reactive Protein

```{r}
CRP <- read.csv(file("CRP.csv"))
CRP$Date.Booked.In = as.Date(CRP$Date.Booked.In, format="%d/%m/%Y")
CRP = CRP %>% 
  rename(
    date = Date.Booked.In,
  )
CRP = CRP %>%
  rename(
    CRP_val = Numeric.Result
  )
```

#### CovidCT - Cycle Threshold (CT) value of PCR for COVID

```{r}
CovidCT <- read.csv(file("CovidCT.csv"))
CovidCT['Measure']='CovidCT'
CovidCT$Specimen.Date = as.Date(CovidCT$Specimen.Date, format="%d/%m/%Y")
CovidCT = CovidCT %>% 
  rename(
    date = Specimen.Date,
  )
```

#### DDM - D-Dimer

```{r}
DDM <- read.csv(file("DDM.csv"))
DDM$Date.Booked.In = as.Date(DDM$Date.Booked.In, format="%d/%m/%Y")
DDM = DDM %>% 
  rename(
    date = Date.Booked.In,
  )
DDM = DDM %>%
  rename(
    DDM_val = Numeric.Result
  )
```

#### eGFR - Estimated Glomerular Filtration Rate

```{r}
eGFR <- read.csv(file("eGFR.csv"))
eGFR$Date.Booked.In = as.Date(eGFR$Date.Booked.In, format="%d/%m/%Y")
eGFR = eGFR %>% 
  rename(
    date = Date.Booked.In,
  )
eGFR = eGFR %>%
  rename(
    eGFR_val = Numeric.Result
  )
```

#### FER - Ferritin

```{r}
FER <- read.csv(file("FER.csv"))
FER$Date.Booked.In = as.Date(FER$Date.Booked.In, format="%d/%m/%Y")
FER = FER %>% 
  rename(
    date = Date.Booked.In,
  )
FER = FER %>%
  rename(
    FER_val = Numeric.Result
  )
```

#### Fib - Fibrinogen

```{r}
fib <- read.csv(file("fib.csv"))
fib$Date.Booked.In = as.Date(fib$Date.Booked.In, format="%d/%m/%Y")
fib = fib %>% 
  rename(
    date = Date.Booked.In,
  )
fib = fib %>%
  rename(
    fib_val = Numeric.Result
  )
```

#### Glucose

```{r}
Glucose <- read.csv(file("Glucose.csv"))
Glucose$Date.Booked.In = as.Date(Glucose$Date.Booked.In, format="%d/%m/%Y")
Glucose = Glucose %>% 
  rename(
    date = Date.Booked.In,
  )
Glucose = Glucose %>%
  rename(
    Glucose_val = Numeric.Result
  )
```

#### HB - Hemoglobin

```{r}
HB <- read.csv(file("HB.csv"))
HB$Date.Booked.In = as.Date(HB$Date.Booked.In, format="%d/%m/%Y")
HB = HB %>% 
  rename(
    date = Date.Booked.In,
  )
HB = HB %>%
  rename(
    HB_val = Numeric.Result
  )
```

#### HBA1c - glycated haemoglobin

```{r}
HBA1c <- read.csv(file("HBA1c.csv"))
HBA1c$Date.Booked.In = as.Date(HBA1c$Date.Booked.In, format="%d/%m/%Y")
HBA1c = HBA1c %>% 
  rename(
    date = Date.Booked.In,
  )
HBA1c = HBA1c %>%
  rename(
    HBA1c_val = Numeric.Result
  )
```

#### LDH - Lactate dehydrogenase

```{r}
LDH <- read.csv(file("LDH.csv"))
LDH$Date.Booked.In = as.Date(LDH$Date.Booked.In, format="%d/%m/%Y")
LDH = LDH %>% 
  rename(
    date = Date.Booked.In,
  )
LDH = LDH %>%
  rename(
    LDH_val = Numeric.Result
  )
```

#### PCT - Procalcitonin

```{r}
PCT <- read.csv(file("PCT.csv"))
PCT$Date.Booked.In = as.Date(PCT$Date.Booked.In, format="%d/%m/%Y")
PCT = PCT %>% 
  rename(
    date = Date.Booked.In,
  )
PCT = PCT %>%
  rename(
    PCT_val = Numeric.Result
  )
```

#### PLT - Platelet Count

```{r}
PLT <- read.csv(file("PLT.csv"))
PLT$Date.Booked.In = as.Date(PLT$Date.Booked.In, format="%d/%m/%Y")
PLT = PLT %>% 
  rename(
    date = Date.Booked.In,
  )
PLT = PLT %>%
  rename(
    PLT_val = Numeric.Result
  )
```

#### Trig - Triglycerides

```{r}
trig <- read.csv(file("trig.csv"))
trig$Date.Booked.In = as.Date(trig$Date.Booked.In, format="%d/%m/%Y")
trig = trig %>% 
  rename(
    date = Date.Booked.In,
  )
trig = trig %>%
  rename(
    trig_val = Numeric.Result
  )
```

#### Trop - Troponin

```{r}
trop <- read.csv(file("trop.csv"))
trop$Date.Booked.In = as.Date(trop$Date.Booked.In, format="%d/%m/%Y")
trop = trop %>% 
  rename(
    date = Date.Booked.In,
  )
trop = trop %>%
  rename(
    trop_val = Numeric.Result
  )
```

#### Vir - Virology

```{r}
Vir <- read.csv(file("Vir.csv"))
Vir['Measure']='Vir'
Vir$Sample.Date = as.Date(Vir$Sample.Date, format="%d/%m/%Y")
Vir = Vir %>% 
  rename(
    date = Sample.Date,
  )
Vir = Vir %>% 
  rename(
    Adenovirus = Adenovirus..PCR.,
  )
Vir = Vir %>% 
  rename(
    Human_Metapneumovirus = Human.metapneumovirus..PCR.,
  )
Vir = Vir %>% 
  rename(
    Influenza_A = Influenza.A..PCR.,
  )
Vir = Vir %>% 
  rename(
    Influenza_B = Influenza.B..PCR.,
  )
Vir = Vir %>% 
  rename(
    Parainfluenza_Type_1 = Parainfluenza.Type.1..PCR.,
  )
Vir = Vir %>% 
  rename(
    Parainfluenza_Type_2 = Parainfluenza.Type.2..PCR.,
  )
Vir = Vir %>% 
  rename(
    Parainfluenza_Type_3 = Parainfluenza.Type.3..PCR.,
  )
Vir = Vir %>% 
  rename(
    Parainfluenza_Type_4 = Parainfluenza.Type.4..PCR.,
  )
Vir = Vir %>% 
  rename(
    Respiratory_Syncytial_Virus = Respiratory.Syncytial.Virus..PCR.,
  )
Vir = Vir %>% 
  rename(
    Rhinovirus = Rhinovirus..PCR.,
  )
```

#### FBC - Full Blood Count

Made up of: \* Lymphocytes \* Neutrophils \* White Cell Count

```{r}
FBC <- read.csv(file("FBC.csv"))
FBC$Date.Booked.In = as.Date(FBC$Date.Booked.In, format="%d/%m/%Y")
FBC = FBC %>% 
  rename(
    date = Date.Booked.In,
  )
```

Split off Lymphocytes:

```{r}
FBCLymph = FBC %>% select(uob_ID,date,Result.Lymphocytes)
FBCLymph = FBCLymph %>% 
  rename(
    Lymphocytes = Result.Lymphocytes,
  )
```

Split off Neutrophils:

```{r}
FBCNeutr = FBC %>% select(uob_ID,date,Result.Neutrophils)
FBCNeutr = FBCNeutr %>% 
  rename(
    Neutrophils = Result.Neutrophils,
  )
```

Split off White Cell Count:

```{r}
FBCWCC = FBC %>% select(uob_ID,date,Result.WCC)
FBCWCC = FBCWCC %>% 
  rename(
    WCC = Result.WCC,
  )
```

Split off Neutrophil to Lymphocyte Ratio

```{r}
FBCNLR = FBC %>% select(uob_ID,date,NLR)
FBCNLR = FBCNLR %>% 
  rename(
    NLR_val = NLR,
  )
```

#### CovidCT - Cycle Threshold (CT) value of PCR for COVID

```{r}
CovidCT <- read.csv(file("CovidCT.csv"))
CovidCT['Measure']='CovidCT'
CovidCT$Specimen.Date = as.Date(CovidCT$Specimen.Date, format="%d/%m/%Y")
CovidCT = CovidCT %>% 
  rename(
    date = Specimen.Date,
  )
```

#### Clot

Made up of: \* APTT - Activated Partial Thromboplastin Time \* PT - Prothrombin Time

```{r}
Clot <- read.csv(file("Clot.csv"))
Clot$Date.Booked.In = as.Date(Clot$Date.Booked.In, format="%d/%m/%Y")
Clot = Clot %>% 
  rename(
    date = Date.Booked.In,
  )
```

Split off APTT:

```{r}
ClotAPTT = Clot %>% select(uob_ID,date,APTT)
ClotAPTT = ClotAPTT %>% 
  rename(
    APTT_val = APTT,
  )
```

Split off PT:

```{r}
ClotPT = Clot %>% select(uob_ID,date,PT)
ClotPT = ClotPT %>% 
  rename(
    PT_val = PT,
  )
```

#### Antigen

```{r}
Antigen <- read.csv(file("Antigen.csv"))
Antigen = Antigen %>% 
  rename(
    date = Date.of.Specimen,
  )
```

#### BC

```{r}
BC <- read.csv(file("BC.csv"))
BC['Measure']='BC'
BC$Date.of.Specimen = as.Date(BC$Date.of.Specimen, format="%d/%m/%Y")
BC = BC %>% 
  rename(
    date = Date.of.Specimen,
  )
```

#### Resp

```{r}
Resp <- read.csv(file("Resp.csv"))
Resp['Measure']='Resp'
Resp$Date.of.Specimen = as.Date(Resp$Date.of.Specimen, format="%d/%m/%Y")
Resp = Resp %>% 
  rename(
    date = Date.of.Specimen,
  )
```

#### Urine

```{r}
Urine <- read.csv(file("Urine.csv"))
Urine['Measure']='Urine'
Urine$Date.of.Specimen = as.Date(Urine$Date.of.Specimen, format="%d/%m/%Y")
Urine = Urine %>% 
  rename(
    date = Date.of.Specimen,
  )
```

#### poctLAC - Point of Care Testing - Lactate

```{r}
poctLAC <- read.csv(file("poctLAC.csv"))
#Format date
poctLAC$Date.of.Specimen = as.Date(poctLAC$Date.of.Specimen, format="%d/%m/%Y")
poctLAC = poctLAC %>% 
  rename(
    date = Date.of.Specimen,
  )
poctLAC = poctLAC %>% 
  rename(
    time = Time.of.Specimen,
  )
poctLAC = poctLAC %>%
  rename(
    poctLAC_val = Numeric.Result
  )
#Combine date and time
poctLAC$dateTime = as.POSIXct(paste(poctLAC$date, poctLAC$time), format="%Y-%m-%d %H:%M:%S")
# Select relevant variables
```

#### poctO2 - Point of Care Testing - O2 and CO2

Made up of: \* O2 \* CO2

```{r}
poctO2 <- read.csv(file("poctO2.csv"))
```

O2:

```{r}
O2 <- poctO2 %>%
  filter(Test.Desc == "Arterial pO2")
O2$Date.of.Specimen = as.Date(O2$Date.of.Specimen, format="%d/%m/%Y")
O2 = O2 %>% 
  rename(
    date = Date.of.Specimen,
  )
O2 = O2 %>% 
  rename(
    time = Time.of.Specimen,
  )
O2 = O2 %>% 
  rename(
    O2_val = Numeric.Result,
  )
#Combine date and time
O2$dateTime = as.POSIXct(paste(O2$date, O2$time), format="%Y-%m-%d %H:%M:%S")
```

CO2:

```{r}
CO2 <- poctO2 %>%
  filter(Test.Desc == "Arterial pCO2")
#Format date
CO2$Date.of.Specimen = as.Date(CO2$Date.of.Specimen, format="%d/%m/%Y")
CO2 = CO2 %>% 
  rename(
    date = Date.of.Specimen,
  )
CO2 = CO2 %>% 
  rename(
    time = Time.of.Specimen,
  )
CO2 = CO2 %>% 
  rename(
    CO2_val = Numeric.Result,
  )
#Combine date and time
CO2$dateTime = as.POSIXct(paste(CO2$date, CO2$time), format="%Y-%m-%d %H:%M:%S")
```

#### poctpH - Point of Care Testing - pH

```{r}
poctpH <- read.csv(file("poctpH.csv"))
#Format date
poctpH$Date.of.Specimen = as.Date(poctpH$Date...Time.of.Specimen, format="%d/%m/%Y")
poctpH = poctpH %>% 
  rename(
    date = Date...Time.of.Specimen,
  )
poctpH = poctpH %>% 
  rename(
    time = Time.of.Specimen,
  )
poctpH = poctpH %>% 
  rename(
    poctpH_val = Numeric.Result,
  )
#Combine date and time
poctpH$dateTime = as.POSIXct(paste(poctpH$date, poctpH$time), format="%Y-%m-%d %H:%M:%S")
```

## AvonCap

```{r}
AvonCap <- read.csv(file("AvonCap.Update.csv"))
AvonCap = AvonCap %>%
    rename(
        Community_Acquired_Pneumonia_radiologically_confirmed = Final.Standard.of.Care.LRTD.related.diagnosis..choice.CAP...radiologically.confirmed.,
        Community_Acquired_Pneumonia_clinically_confirmed = Final.Standard.of.Care.LRTD.related.diagnosis..choice.CAP...clinically.confirmed..but.not.on.radiology..,
        Community_Acquired_Pneumonia_no_radiology_performed = Final.Standard.of.Care.LRTD.related.diagnosis..choice.CAP...no.radiology.performed.,
        Acute_bronchitis = Final.Standard.of.Care.LRTD.related.diagnosis..choice.Acute.bronchitis.,
        Exacerbation_of_COPD = Final.Standard.of.Care.LRTD.related.diagnosis..choice.Exacerbation.of.COPD.,
        Empyema_lung_abscess = Final.Standard.of.Care.LRTD.related.diagnosis..choice.Empyema.lung.abscess.,
        LRTI_not_further_specified = Final.Standard.of.Care.LRTD.related.diagnosis..choice.LRTI...not.further.specified.,
        Congestive_heart_failure = Final.Standard.of.Care.LRTD.related.diagnosis..choice.Congestive.heart.failure.,
        Non_infectious_process = Final.Standard.of.Care.LRTD.related.diagnosis..choice.Non.infectious.process.,
        Non_LRTD_infection_related_diagnosis = Final.Standard.of.Care.LRTD.related.diagnosis..choice.Non.LRTD.infection.related.diagnosis.,
        Other_LRTI_specified = Other.LRTI.Specified,
        NYHA_Heart_failure = NYHA...Heart.Failure..nbsp.,
        CRB65_Score = CRB65.Score,
        NEWS2_Score = NEWS.2.Score,
        Respiratory_Disease_None = Respiratory.Disease..choice.None.,
        COPD = Respiratory.Disease..choice.COPD..Chronic.Obstructive.Pulmonary.Disease.Emphysema..,
        Asthma = Respiratory.Disease..choice.Asthma.,
        Bronchiectasis = Respiratory.Disease..choice.Bronchiectasis.,
        Pulmonary_Fibrosis_Interstitial_Lung_Disease = Respiratory.Disease..choice.Pulmonary.Fibrosis.Interstitial.Lung.Disease.,
        Respiratory_Disease_other = Respiratory.Disease..choice.Other.,
        Chronic_heart_disease_none = Chronic.Heart.Disease..choice.None.,
        Hypertension = Chronic.Heart.Disease..choice.Hypertension.,
        Atrial_Fibrillation = Chronic.Heart.Disease..choice.Atrial.Fibrillation.,
        Ischaemic_heart_disease = Chronic.Heart.Disease..choice.Ischaemic.heart.disease.,
        Heart_failure = Chronic.Heart.Disease..choice.Heart.failure.CCF.,
        Chronic_heart_disease_other = Chronic.Heart.Disease..choice.Other.,
        Chronic_Kidney_Disease = Chronic.Kidney.Disease..CKD..Mod.Severe..eGFR..30..Cr.265.umol.L..dialysis..transplantation..uremic.syndrome,
        Liver_disease = Liver.Disease.Mild...nbsp.cirrhosis.without.portal.HTN..chronic.hepatitis..Mod.Severe...nbsp.cirrhosis.with.portal.HTN.....variceal.bleeding,
        Diabetes = Diabetes,
        Cognitive_Impairment_Dementia_none = Cognitive.Impairment.Dementia..choice.None.,
        Dementia = Cognitive.Impairment.Dementia..choice.Dementia.,
        Cognitive_impairment = Cognitive.Impairment.Dementia..choice.Cognitive.Impairment.,
        CVA_Stroke = Cognitive.Impairment.Dementia..choice.CVA..stroke..,
        TIA_mini_stroke = Cognitive.Impairment.Dementia..choice.TIA..mini.stroke..,
        Hemiplegiahemiplegia_or_paraplegia = Hemiplegiahemiplegia.or.paraplegia,
        Peripheral_vascular_disease = Peripheral.Vascular.Disease.Intermittent.claudication..periph..arterial.bypass.for.insufficiency..gangrene..acute.arterial.insufficiency..untreated.aneurysm....6cm..nbsp.,
        Immunosuppressive_medication = Immunosuppressive.Medication.includes.oral.steroids..biologics..chemotherapy.,
        Immunodeficiency = Immunodeficiency.eg.SCID..hypogammaglobulinaemia..splenectomy.,
        Connective_tissue_disease = Connective.Tissue.Disease..SLE..polymyositis..mixed.nbsp.Connective.Tissue.Disease..polymyalgia.rheumatica..moderate.to.severe.Rheumatoid.Arthritis.,
        HIV_negative_or_not_tested = HIV.status..choice.Negative..no.HIV...or.not.tested.,
        HIV_positive = HIV.status..choice.HIV.,
        AIDS = HIV.status..choice.AIDS.,
        Solid_organ_cancer_malignancy = Solid.Organ.Cancer.Malignancy.Initially.treated.in.the.last.5.years.exclude.non.melanomatous.skin.cancers.and.in.situ.cervical.carcinoma,
        Haematological_malignancy_leukaemia_none = Haematological.Malignancy.Leukaemia...nbsp.CML..CLL..AML..ALL..Polycythaemia.Vera.Lymphoma...nbsp.NHL..Hodgkin.s..WaldenstrÃ.m..multiple.myeloma...choice.None.,
        Leukaemia = Haematological.Malignancy.Leukaemia...nbsp.CML..CLL..AML..ALL..Polycythaemia.Vera.Lymphoma...nbsp.NHL..Hodgkin.s..WaldenstrÃ.m..multiple.myeloma...choice.Leukaemia.,
        Lymphoma = Haematological.Malignancy.Leukaemia...nbsp.CML..CLL..AML..ALL..Polycythaemia.Vera.Lymphoma...nbsp.NHL..Hodgkin.s..WaldenstrÃ.m..multiple.myeloma...choice.Lymphoma.,
        Organ_transplantation = Organ.Transplantation,
        Pregnancy_post_partum = Pregnancy.Post.partum,
        Gastric_Duodenal_Ulcer_disease = Gastric.Duodenal.Ulcer.Disease.Patients.who.have.required.treatment.for.PUD.nbsp.,
        Rockwood_frailty_score = Rockwood.Frailty.Score,
        Radiology_result = Radiology.Result
    )
```

### Merge tables

```{r}
BE <- subset(BE, BE_val < 57.5)
BNP$BNP_val <- log10(BNP$BNP_val)
ClotAPTT$APTT_val <- log10(ClotAPTT$APTT_val)
ClotPT$PT_val <- log10(ClotPT$PT_val)
CO2$CO2_val <- log10(CO2$CO2_val)
O2$O2_val <- log10(O2$O2_val)
CRP$CRP_val <- (CRP$CRP_val)^(1/3)
DDM$DDM_val <- log10(DDM$DDM_val)
FBCLymph$Lymphocytes <- log10(FBCLymph$Lymphocytes)
FBCNeutr$Neutrophils <- (FBCNeutr$Neutrophils)^(1/3)
FBCNLR$NLR_val <- log10(FBCNLR$NLR_val)
FBCWCC$WCC <- (FBCWCC$WCC)^(1/3)
FER$FER_val <- log10(FER$FER_val)
Glucose$Glucose_val <- log10(Glucose$Glucose_val)
HBA1c$HBA1c_val <- (HBA1c$HBA1c_val)^(1/3)
LDH$LDH_val <- log10(LDH$LDH_val)
PCT$PCT_val <- log10(PCT$PCT_val)
PLT$PLT_val <- sqrt(PLT$PLT_val)
poctLAC$poctLAC_val <- log10(poctLAC$poctLAC_val)
trig$trig_val <- log10(trig$trig_val)
trop$trop_val <- log10(trop$trop_val)
```

```{r}
#BE = rename(BE,BE_val = Numeric.Result )
BE$BE_val <- rescale(BE$BE_val)
BE = BE %>% select(uob_ID,date,BE_val)
BE['Measure'] = 'BE'
BE = BE %>%
    rename ( 
        Numeric.Result = BE_val
    )

BNP$BNP_val <- rescale(BNP$BNP_val)
BNP = BNP %>% select(uob_ID,date,BNP_val)
BNP['Measure'] = 'BNP'
BNP = BNP %>%
    rename ( 
        Numeric.Result = BNP_val
    )

CRP$CRP_val <- rescale(CRP$CRP_val)
CRP = CRP %>% select(uob_ID,date,CRP_val)
CRP['Measure'] = 'CRP'
CRP = CRP %>%
    rename ( 
        Numeric.Result = CRP_val
    )

DDM$DDM_val <- rescale(DDM$DDM_val)
DDM = DDM %>% select(uob_ID,date,DDM_val)
DDM['Measure'] = 'DDM'
DDM = DDM %>%
    rename ( 
        Numeric.Result = DDM_val
    )

eGFR$eGFR_val <- rescale(eGFR$eGFR_val)
eGFR = eGFR %>% select(uob_ID,date,eGFR_val)
eGFR['Measure'] = 'eGFR'
eGFR = eGFR %>%
    rename ( 
        Numeric.Result = eGFR_val
    )

FER$FER_val <- rescale(FER$FER_val)
FER = FER %>% select(uob_ID,date,FER_val)
FER['Measure'] = 'FER'
FER = FER %>%
    rename ( 
        Numeric.Result = FER_val
    )

fib$fib_val <- rescale(fib$fib_val)
fib = fib %>% select(uob_ID,date,fib_val)
fib['Measure'] = 'fib'
fib = fib %>%
    rename ( 
        Numeric.Result = fib_val
    )

Glucose$Glucose_val <- rescale(Glucose$Glucose_val)
Glucose = Glucose %>% select(uob_ID,date,Glucose_val)
Glucose['Measure'] = 'Glucose'
Glucose = Glucose %>%
    rename ( 
        Numeric.Result = Glucose_val
    )

HB$HB_val <- rescale(HB$HB_val)
HB = HB %>% select(uob_ID,date,HB_val)
HB['Measure'] = 'HB'
HB = HB %>%
    rename ( 
        Numeric.Result = HB_val
    )

ClotAPTT$APTT_val <- rescale(ClotAPTT$APTT_val)
ClotAPTT = ClotAPTT %>% select(uob_ID,date,APTT_val)
ClotAPTT['Measure'] = 'APTT'
ClotAPTT = ClotAPTT %>%
    rename ( 
        Numeric.Result = APTT_val
    )

ClotPT$PT_val <- rescale(ClotPT$PT_val)
ClotPT = ClotPT %>% select(uob_ID,date,PT_val)
ClotPT['Measure'] = 'PT'
ClotPT = ClotPT %>%
    rename ( 
        Numeric.Result = PT_val
    )

CO2$CO2_val <- rescale(CO2$CO2_val)
CO2 = CO2 %>% select(uob_ID,date,CO2_val)
CO2['Measure'] = 'CO2'
CO2 = CO2 %>%
    rename ( 
        Numeric.Result = CO2_val
    )

O2$O2_val <- rescale(O2$O2_val)
O2 = O2 %>% select(uob_ID,date,O2_val)
O2['Measure'] = 'O2'
O2 = O2 %>%
    rename ( 
        Numeric.Result = O2_val
    )

FBCLymph$Lymphocytes <- rescale(FBCLymph$Lymphocytes)
FBCLymph = FBCLymph %>% select(uob_ID,date,Lymphocytes)
FBCLymph['Measure'] = 'Lymphocytes'
FBCLymph = FBCLymph %>%
    rename ( 
        Numeric.Result = Lymphocytes
    )

FBCNeutr$Neutrophils <- rescale(FBCNeutr$Neutrophils)
FBCNeutr = FBCNeutr %>% select(uob_ID,date,Neutrophils)
FBCNeutr['Measure'] = 'Neutrophils'
FBCNeutr = FBCNeutr %>%
    rename ( 
        Numeric.Result = Neutrophils
    )

FBCNLR$NLR_val <- rescale(FBCNLR$NLR_val)
FBCNLR = FBCNLR %>% select(uob_ID,date,NLR_val)
FBCNLR['Measure'] = 'NLR'
FBCNLR = FBCNLR %>%
    rename ( 
        Numeric.Result = NLR_val
    )

FBCWCC$WCC <- rescale(FBCWCC$WCC)
FBCWCC = FBCWCC %>% select(uob_ID,date,WCC)
FBCWCC['Measure'] = 'WCC'
FBCWCC = FBCWCC %>%
    rename ( 
        Numeric.Result = WCC
    )

HBA1c$HBA1c_val <- rescale(HBA1c$HBA1c_val)
HBA1c = HBA1c %>% select(uob_ID,date,HBA1c_val)
HBA1c['Measure'] = 'HBA1c'
HBA1c = HBA1c %>%
    rename ( 
        Numeric.Result = HBA1c_val
    )

poctpH$poctpH_val <- rescale(poctpH$poctpH_val)
poctpH = poctpH %>% select(uob_ID,date,poctpH_val)
poctpH['Measure'] = 'poctpH'
poctpH$date = as.Date(poctpH$date, format="%d/%m/%Y")
poctpH = poctpH %>%
    rename ( 
        Numeric.Result = poctpH_val
    )


poctLAC$poctLAC_val <- rescale(poctLAC$poctLAC_val)
poctLAC = poctLAC %>% select(uob_ID,date,poctLAC_val)
poctLAC['Measure'] = 'poctLAC'
poctLAC = poctLAC %>%
    rename ( 
        Numeric.Result = poctLAC_val
    )

LDH$LDH_val <- rescale(LDH$LDH_val)
LDH = LDH %>% select(uob_ID,date,LDH_val)
LDH['Measure'] = 'LDH'
LDH = LDH %>%
    rename ( 
        Numeric.Result = LDH_val
    )

PCT$PCT_val <- rescale(PCT$PCT_val)
PCT = PCT %>% select(uob_ID,date,PCT_val)
PCT['Measure'] = 'PCT'
PCT = PCT %>%
    rename ( 
        Numeric.Result = PCT_val
    )

PLT$PLT_val <- rescale(PLT$PLT_val)
PLT = PLT %>% select(uob_ID,date,PLT_val)
PLT['Measure'] = 'PLT'
PLT = PLT %>%
    rename ( 
        Numeric.Result = PLT_val
    )

trig$trig_val <- rescale(trig$trig_val)
trig = trig %>% select(uob_ID,date,trig_val)
trig['Measure'] = 'trig'
trig = trig %>%
    rename ( 
        Numeric.Result = trig_val
    )

trop$trop_val <- rescale(trop$trop_val)
trop = trop %>% select(uob_ID,date,trop_val)
trop['Measure'] = 'trop'
trop = trop %>%
    rename ( 
        Numeric.Result = trop_val
    )
```

```{r}
total <- rbind(BE,BNP,CRP,DDM,eGFR,FER,fib,Glucose,HB,ClotAPTT,ClotPT,CO2,O2,FBCLymph,FBCNeutr,FBCNLR,FBCWCC,HBA1c,poctpH,poctLAC,LDH,PCT,PLT,trig,trop)
total$Measure <- factor(total$Measure, levels = c("BNP","LDH","HBA1c","trig","trop","DDM","FER","PCT","fib","Glucose","PT","APTT","PLT","CRP","eGFR","poctLAC","poctpH","O2","CO2","WCC","Lymphocytes","Neutrophils","NLR","HB","BE"))
```

```{r}
total = total %>% rename(Normalized_value = Numeric.Result)
```

## Individual Patient Visualisation

To show individual patient data, please use this function, of the form

    show_patient_info(patientID)

```{r, results='asis'}

show_patient_viz <- function(patientID) {
  val_outcome = subset(dem, uob_ID==patientID)[1,]
  gender = val_outcome$Gender
  age = val_outcome$Age
  date = (total %>% filter(uob_ID==patientID))[1,]$date
  new_data = total %>% filter(uob_ID==patientID)
  new_data$Measure <- factor(new_data$Measure, levels = c("BNP","LDH","HBA1c","trig","trop","DDM","FER","PCT","fib","Glucose","PT","APTT","PLT","CRP","eGFR","poctLAC","poctpH","O2","CO2","WCC","Lymphocytes","Neutrophils","NLR","HB","BE"))
  p <- ( ggplot() + 
           ggtitle(paste(i, ", Patient",patientID,"summary")) + 
           labs(subtitle=paste("Gender:",val_outcome$Gender,"Age:",val_outcome$Age)) +
           geom_tile(new_data, mapping=aes(date, Measure, fill= Normalized_value)) + 
           scale_fill_viridis_c(na.value = "grey50",option = "plasma")+
           scale_y_discrete(drop=FALSE,limits=(rev(levels(new_data$Measure))))+
           scale_x_date(labels=date_format(format="%Y-%m-%d"))
  )
  # Plot Covid Positive test
  if(length((CovidCT %>% filter(CovidCT$uob_ID==patientID))$date) > 0){
    if(!is.null((CovidCT %>% filter(CovidCT$uob_ID==patientID))$date) && !is.na((CovidCT %>% filter(CovidCT$uob_ID==patientID))$date)){
      positiveDate = (CovidCT %>% filter(CovidCT$uob_ID==patientID))[1,]$date
      p = p + geom_text(data= (CovidCT %>% filter(CovidCT$uob_ID==patientID))[1,], mapping=aes(x=date,y=1,label="Positive"),colour="red",show.legend = FALSE) +
        geom_vline(data= (CovidCT %>% filter(CovidCT$uob_ID==patientID))[1,], mapping=aes(xintercept = date, colour="red"),show.legend = FALSE)
    }
  }
  # Plot hospital admission
  if(length((totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))$admissionDate) > 0){
    if(!is.null((totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))$admissionDate) && !is.na((totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))$admissionDate)){
      for(val2 in 1:length(totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))){
        admissionDate = (totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))[val2,]$admissionDate
        p = p + geom_text(data= (totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))[val2,], mapping=aes(x=admissionDate,y=2,label="Admission"),colour="blue",show.legend = FALSE) + 
        geom_vline(xintercept = admissionDate, colour="blue",show.legend = FALSE)
      }
    }
  }
  # Plot ICU admission
  if(length((totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))$ITU_Start) > 0){
    if(!is.null((totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))$ITU_Start) && !is.na((totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))$ITU_Start)){
      for(val2 in 1:length(totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))){
        ITU_Start = (totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))[val2,]$ITU_Start
        p = p + geom_text(data= (totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))[val2,], mapping=aes(x=ITU_Start,y=3,label="ICU Start"),colour="blue",show.legend = FALSE) + 
        geom_vline(xintercept = ITU_Start, colour="blue",show.legend = FALSE)
      }
    }
  }
  # Plot ICU discharge
  if(length((totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))$ITU_End) > 0){
    if(!is.null((totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))$ITU_End) && !is.na((totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))$ITU_End)){
      for(val2 in 1:length(totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))){
        ITU_End = (totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))[val2,]$ITU_End
        p = p + geom_text(data= (totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))[val2,], mapping=aes(x=ITU_End,y=4,label="ICU End"),colour="blue",show.legend = FALSE) + 
        geom_vline(xintercept = ITU_End, colour="blue",show.legend = FALSE)
      }
    }
  }
  # Plot date of death
  if(length((totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))$deathDate) > 0){
    if(!is.na((totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))$deathDate)){
      deathDate = (totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))[1,]$deathDate
      p = p + geom_text(data= (totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))[1,], mapping=aes(x=deathDate,y=5,label="Death"),colour="red",show.legend = FALSE) +
      geom_vline(xintercept = deathDate, colour="red",show.legend = FALSE)
    }else{
      for(val2 in 1:length(totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))){
        dischargeDate = (totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))[val2,]$dischargeDate
        # Plot discharge
        p = p + geom_text(data= (totalOutcomes %>% filter(totalOutcomes$uob_ID==patientID))[val2,], mapping=aes(x=dischargeDate,y=6,label="Discharged"),colour="green",show.legend = FALSE) +
        geom_vline(xintercept = dischargeDate, colour="green",show.legend = FALSE)
      }
    }
  }
  
  #fig <- ggplotly(p)
  cat("#### Visualisation")
  cat("\n\n")
  print(p)
  cat("\n\n")
}
```

```{r, results='asis'}
total_outcome_info <- function(patientID) {
    cat("\n\n")
    cat("#### Outcomes")
    print(kable(totalOutcomes[totalOutcomes$uob_ID==patientID,]))
    cat("\n\n")
}     
```

```{r, results= 'asis'}
vir_info <- function(patientID) {
    cat(paste("#### Virology"))
    info <- filter(Vir,Vir$uob_ID==patientID)
    info <- info %>% select(uob_ID,date,SARS.CoV.2.RNA,Adenovirus,Human_Metapneumovirus,Influenza_A,Influenza_B,Parainfluenza_Type_1,Parainfluenza_Type_2,Parainfluenza_Type_3,Parainfluenza_Type_4,Respiratory_Syncytial_Virus,Rhinovirus)
    print(kable(info))
    cat("\n\n")
}
```

```{r, results= 'asis'}
bc_info <- function(patientID) {
    cat("#### Blood Culture")
    info <- filter(BC,BC$uob_ID==patientID)
    print(kable(info))
    cat("\n\n")
}
```

```{r, results= 'asis'}
avonCap_info <- function(patientID) {
    info <- filter(AvonCap,AvonCap$uob_ID==patientID)
    if(length(info[,1]) > 0){
        cat("#### AvonCap")
        info <- info %>% select(uob_ID,Community_Acquired_Pneumonia_radiologically_confirmed, Community_Acquired_Pneumonia_clinically_confirmed, Community_Acquired_Pneumonia_no_radiology_performed, Acute_bronchitis, Exacerbation_of_COPD, Empyema_lung_abscess, LRTI_not_further_specified, Congestive_heart_failure, Non_infectious_process, Non_LRTD_infection_related_diagnosis, Other_LRTI_specified, NYHA_Heart_failure, CRB65_Score, NEWS2_Score, Respiratory_Disease_None, COPD, Asthma, Bronchiectasis, Pulmonary_Fibrosis_Interstitial_Lung_Disease, Respiratory_Disease_other, Chronic_heart_disease_none, Hypertension, Atrial_Fibrillation, Ischaemic_heart_disease, Heart_failure, Chronic_heart_disease_other, Chronic_Kidney_Disease, Liver_disease, Diabetes, Cognitive_Impairment_Dementia_none, Dementia, Cognitive_impairment, CVA_Stroke, TIA_mini_stroke, Hemiplegiahemiplegia_or_paraplegia, Peripheral_vascular_disease, Immunosuppressive_medication, Immunodeficiency, Connective_tissue_disease, HIV_negative_or_not_tested, HIV_positive, AIDS, Solid_organ_cancer_malignancy, Haematological_malignancy_leukaemia_none, Leukaemia, Lymphoma, Organ_transplantation, Pregnancy_post_partum, Gastric_Duodenal_Ulcer_disease, Rockwood_frailty_score, Radiology_result)
        info <- as.data.frame(t(info))
        print(kable(info))
        cat("\n\n")
    }
}
```

```{r, results='asis'}

#read list of valid UOB Ids
ID_list = read.csv('totalBinary31.csv')

#we parse the list into validation (Weston) vs train (UHB, NBT)
train_id_list = ID_list[ID_list$Site != 'Weston', 'ID']
test_id_list = ID_list[ID_list$Site == 'Weston','ID']

#NOTE the visualisation will only do train or test not both - alter ID_list for the desired set
ID_list = train_id_list

#create a store number of days from covid positive to first measure per patient
days_to_reading_mt = matrix(data = NA, nrow = length(ID_list), ncol = length(levels(total$Measure)))
colnames(days_to_reading_mt) <- levels(total$Measure)

#make a copy to track number of readings per person/measure
num_readings_mt = days_to_reading_mt
#make a copy for a matrix to track number of days between admit & c19 positive
days_between_admit_c19positive_mt = matrix(data = NA, nrow = length(ID_list), ncol = 1)

covid_ls = matrix( data = TRUE, nrow = length(ID_list), ncol = 1 )

#prepare structure to find IDs who have very long waits till first reading
ReadingOutlier_tb = tibble(ID = '', READING = '', DAYS = NA)
ctr = 0

for (i in (1:length(ID_list))) { #use only valid UOB ids
  
    #grab some data on patient and tests (copied from show_patient_viz)
    patientID = ID_list[i]
    admitDate = (totalOutcomes %>% filter(totalOutcomes$uob_ID == patientID))$admissionDate
    positiveDate = (CovidCT %>% filter(CovidCT$uob_ID == patientID))[1,]$date
    val_outcome = subset(dem, uob_ID == patientID)[1,]
    new_data = total %>% filter(uob_ID == patientID)
    
    #check if they had a positive test and at least 18
    if (!is.na(positiveDate) & (dem$Age[i] > 17) ) {
      unique_measures_ls = unique(new_data$Measure)
      
      days_between_admit_c19positive_mt[i] = as.numeric(admitDate - positiveDate)
      #find amount of days from positive to first test for each test
      for (j in unique_measures_ls) {
        idx1 = new_data$Measure == j
        days_between_pos_reading = positiveDate - new_data$date[idx1]
        
        #index to see if any readings AFTER covid test
        idx2 = days_between_pos_reading >= 0
        if (sum(idx2) > 0) {
          minimum_day = min(days_between_pos_reading[idx2])
          
          if (minimum_day > 10) {
            ctr = ctr + 1
            ReadingOutlier_tb[ctr,1] = patientID
            ReadingOutlier_tb[ctr,2] = j
            ReadingOutlier_tb[ctr,3] = minimum_day
          }
          
          days_to_reading_mt[i,j] = minimum_day[[1]]
          num_readings_mt[i,j] = sum(idx2)
          
        }
      }
      cat("### Visualisation of patient", patientID)
      cat("\n\n")
      
      if(1) { #if you want visualization
        suppressWarnings(show_patient_viz(patientID))
        total_outcome_info(patientID)
        bc_info(patientID)
        vir_info(patientID)
        avonCap_info(patientID)
      }
    } else { #record the index for the patient without confirmed covid
      covid_ls[i] = FALSE
      }
    
}

columns = c("numReadings","Within1days","Over1Days", "Within3days","Over3Days", "Within5days","Over5Days") 
reading_stats = data.frame(matrix(nrow = 0, ncol = length(columns))) 
colnames(reading_stats) = columns

for (j in colnames(days_to_reading_mt)) {
  
  #select only valid cases
  tmp = days_to_reading_mt[covid_ls,j]
  d_t_r_nonans = tmp[!is.na(tmp)]
  hist(d_t_r_nonans, xlab = 'Days from Cov+ to first reading', 
       main = paste(j, ': Days to first reading'),
       breaks = c(0:max(d_t_r_nonans)))
  
  #select only valid cases
  tmp = num_readings_mt[covid_ls,j]
  n_r_nonans = tmp[!is.na(tmp)]
  hist(n_r_nonans, xlab = 'Number of readings', main = paste(j, ': Number readings'),
       breaks = c(0:max(n_r_nonans)))
  
  #compute some helpful stats
  num_first_read = length(d_t_r_nonans)
  
  read_within1 = sum(d_t_r_nonans < 2)
  read_over1 = sum(d_t_r_nonans > 1)
  
  read_within3 = sum(d_t_r_nonans < 4)
  read_over3 = sum(d_t_r_nonans > 3)
  
  read_within5 = sum(d_t_r_nonans < 6)
  read_over5 = sum(d_t_r_nonans > 5)
  
  reading_stats[j,]=c(num_first_read, read_within1, read_over1,read_within3, read_over3,read_within5, read_over5)
  
  
}

hist(days_between_admit_c19positive_mt, xlab = 'Days from Admit to Cov+', 
     main = paste('Days between admission and c19+'))




```
